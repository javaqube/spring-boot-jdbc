(function(){"use strict";function r(r,e){return{notLogonHandler:function(){r.create({className:"danger",content:"未登录,请登录"}),e.go("auth.login",{location:!0,reload:!0})},errorLogonHandler:function(e){r.create({className:"danger",content:"登录失败"+e.errMsg})},toastError:function(e){r.create({className:"danger",content:e.errMsg})}}}angular.module("craft.auth.handler",["ngToast"]),angular.module("craft.auth.handler").factory("AuthHandlerService",r),r.$inject=["ngToast","$state"]}).call(this),function(){"use strict";function r(r,e,t,n,o,a){var u=angular.extend({});return u.isLoggedIn=function(){var e=JSON.parse(r.retrieve());return!!e},u.currentUser=function(){if(this.isLoggedIn())return r.retrieve()},u.logon=function(u,c){var i=e.defer(),s=t.getAppConfig().RootPath+"/logon",l={userName:u,password:c},f="params="+JSON.stringify(l);return a.post(s,f).then(function(e){n.service("userService","getUserInfo").then(function(e){r.create(e),o.go("home.default",{location:!0,reload:!0})},function(r){console.log(r)}),i.resolve("logon success")},function(r){i.reject(r)}),i.promise},u.logout=function(){var e=t.getAppConfig().RootPath+"/logout";a["delete"](e).then(function(r){}),r.logout(),o.go("auth.login",{location:!0,reload:!0})},u}angular.module("craft.auth.AuthService",["craft.api.cap"]),angular.module("craft.auth.AuthService").factory("SessionAuthService",r),r.$inject=["UserStorage","$q","ConfigService","CrudService","$state","HttpService"]}.call(this),function(){"use strict";function r(r,t,n,o){r.login=function(){return r.user&&r.user.username?r.user.password?void t.logon(r.user.username,e(r.user.password)).then(function(){n.create("登录成功")},function(r){o.errorLogonHandler(r)}):void alert("请填写密码"):void alert("请填写用户名")},r.isLoggedIn=function(){return t.isLoggedIn()},r.currentUser=function(){return t.currentUser()},r.logout=function(){t.logout()}}function e(r){function e(r,e){return r<<e|r>>>32-e}function t(r,e){var t,n,o,a,u;return o=2147483648&r,a=2147483648&e,t=1073741824&r,n=1073741824&e,u=(1073741823&r)+(1073741823&e),t&n?2147483648^u^o^a:t|n?1073741824&u?3221225472^u^o^a:1073741824^u^o^a:u^o^a}function n(r,e,t){return r&e|~r&t}function o(r,e,t){return r&t|e&~t}function a(r,e,t){return r^e^t}function u(r,e,t){return e^(r|~t)}function c(r,o,a,u,c,i,s){return r=t(r,t(t(n(o,a,u),c),s)),t(e(r,i),o)}function i(r,n,a,u,c,i,s){return r=t(r,t(t(o(n,a,u),c),s)),t(e(r,i),n)}function s(r,n,o,u,c,i,s){return r=t(r,t(t(a(n,o,u),c),s)),t(e(r,i),n)}function l(r,n,o,a,c,i,s){return r=t(r,t(t(u(n,o,a),c),s)),t(e(r,i),n)}function f(r){for(var e,t=r.length,n=t+8,o=(n-n%64)/64,a=16*(o+1),u=Array(a-1),c=0,i=0;i<t;)e=(i-i%4)/4,c=i%4*8,u[e]=u[e]|r.charCodeAt(i)<<c,i++;return e=(i-i%4)/4,c=i%4*8,u[e]=u[e]|128<<c,u[a-2]=t<<3,u[a-1]=t>>>29,u}function g(r){var e,t,n="",o="";for(t=0;t<=3;t++)e=r>>>8*t&255,o="0"+e.toString(16),n+=o.substr(o.length-2,2);return n}function h(r){r=r.replace(/\r\n/g,"\n");for(var e="",t=0;t<r.length;t++){var n=r.charCodeAt(t);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.frameElement(63&n|128))}return e}var d,v,S,m,p,C,A,L,$,I=Array(),U=7,H=12,y=17,N=22,w=5,j=9,P=14,T=20,E=4,J=11,M=16,O=23,R=6,b=10,q=15,x=21;for(r=h(r),I=f(r),C=1732584193,A=4023233417,L=2562383102,$=271733878,d=0;d<I.length;d+=16)v=C,S=A,m=L,p=$,C=c(C,A,L,$,I[d+0],U,3614090360),$=c($,C,A,L,I[d+1],H,3905402710),L=c(L,$,C,A,I[d+2],y,606105819),A=c(A,L,$,C,I[d+3],N,3250441966),C=c(C,A,L,$,I[d+4],U,4118548399),$=c($,C,A,L,I[d+5],H,1200080426),L=c(L,$,C,A,I[d+6],y,2821735955),A=c(A,L,$,C,I[d+7],N,4249261313),C=c(C,A,L,$,I[d+8],U,1770035416),$=c($,C,A,L,I[d+9],H,2336552879),L=c(L,$,C,A,I[d+10],y,4294925233),A=c(A,L,$,C,I[d+11],N,2304563134),C=c(C,A,L,$,I[d+12],U,1804603682),$=c($,C,A,L,I[d+13],H,4254626195),L=c(L,$,C,A,I[d+14],y,2792965006),A=c(A,L,$,C,I[d+15],N,1236535329),C=i(C,A,L,$,I[d+1],w,4129170786),$=i($,C,A,L,I[d+6],j,3225465664),L=i(L,$,C,A,I[d+11],P,643717713),A=i(A,L,$,C,I[d+0],T,3921069994),C=i(C,A,L,$,I[d+5],w,3593408605),$=i($,C,A,L,I[d+10],j,38016083),L=i(L,$,C,A,I[d+15],P,3634488961),A=i(A,L,$,C,I[d+4],T,3889429448),C=i(C,A,L,$,I[d+9],w,568446438),$=i($,C,A,L,I[d+14],j,3275163606),L=i(L,$,C,A,I[d+3],P,4107603335),A=i(A,L,$,C,I[d+8],T,1163531501),C=i(C,A,L,$,I[d+13],w,2850285829),$=i($,C,A,L,I[d+2],j,4243563512),L=i(L,$,C,A,I[d+7],P,1735328473),A=i(A,L,$,C,I[d+12],T,2368359562),C=s(C,A,L,$,I[d+5],E,4294588738),$=s($,C,A,L,I[d+8],J,2272392833),L=s(L,$,C,A,I[d+11],M,1839030562),A=s(A,L,$,C,I[d+14],O,4259657740),C=s(C,A,L,$,I[d+1],E,2763975236),$=s($,C,A,L,I[d+4],J,1272893353),L=s(L,$,C,A,I[d+7],M,4139469664),A=s(A,L,$,C,I[d+10],O,3200236656),C=s(C,A,L,$,I[d+13],E,681279174),$=s($,C,A,L,I[d+0],J,3936430074),L=s(L,$,C,A,I[d+3],M,3572445317),A=s(A,L,$,C,I[d+6],O,76029189),C=s(C,A,L,$,I[d+9],E,3654602809),$=s($,C,A,L,I[d+12],J,3873151461),L=s(L,$,C,A,I[d+15],M,530742520),A=s(A,L,$,C,I[d+2],O,3299628645),C=l(C,A,L,$,I[d+0],R,4096336452),$=l($,C,A,L,I[d+7],b,1126891415),L=l(L,$,C,A,I[d+14],q,2878612391),A=l(A,L,$,C,I[d+5],x,4237533241),C=l(C,A,L,$,I[d+12],R,1700485571),$=l($,C,A,L,I[d+3],b,2399980690),L=l(L,$,C,A,I[d+10],q,4293915773),A=l(A,L,$,C,I[d+1],x,2240044497),C=l(C,A,L,$,I[d+8],R,1873313359),$=l($,C,A,L,I[d+15],b,4264355552),L=l(L,$,C,A,I[d+6],q,2734768916),A=l(A,L,$,C,I[d+13],x,1309151649),C=l(C,A,L,$,I[d+4],R,4149444226),$=l($,C,A,L,I[d+11],b,3174756917),L=l(L,$,C,A,I[d+2],q,718787259),A=l(A,L,$,C,I[d+9],x,3951481745),C=t(C,v),A=t(A,S),L=t(L,m),$=t($,p);return(g(C)+g(A)+g(L)+g($)).toLowerCase()}angular.module("craft.auth.session",["craft.auth.handler","craft.auth.AuthService","craft.auth.UserStorage"]),angular.module("craft.auth.session").run(["$rootScope","$state","AuthHandlerService","SessionAuthService",function(r,e,t,n){r.$on("$stateChangeStart",function(r,e){n.isLoggedIn()||null!==e["protected"]&&e["protected"]===!0&&(r.preventDefault(),t.notLogonHandler())})}]),angular.module("craft.auth.session").controller("UserProfileCtrl",["$scope","AuthService","ngToast","AuthHandlerService",r])}.call(),function(){"use strict";angular.module("craft.auth.UserStorage",[]).service("UserStorage",function(){this.create=function(r){localStorage.setItem("user",r)},this.retrieve=function(){return localStorage.getItem("user")},this.destroy=function(){localStorage.removeItem("user")}})}.call(this);